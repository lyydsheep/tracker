# 图解HTTP

## 了解WEB及网络基础

### 1.1使用HTTP协议访问WEB

WEB使用一种名为HTTP（HyperText Transfer Protocol）的协议作为规范（规则），完成从client到service等一系列运作流程。可以说，WEB是建立在HTTP协议上通信的。

![image-20240116173647737](https://gitee.com/lyydsheep/pic/raw/master/202401161736866.png)

### 1.2网络基础TCP/IP

#### 1.2.1TCP/IP协议族

计算机与网络设备、不同的硬件、操作系统之间要相互进行通信，双方就必须基于相同的通信方法，即受一定的规则约束。而我们就把这种规则称为协议（protocol）。

TCP/IP是互联网相关的各类协议族的总称，HTTP协议是TCP/IP协议族的一个子集

![image-20240116174306677](https://gitee.com/lyydsheep/pic/raw/master/202401161743742.png)

#### 1.2.2TCP/IP的分层管理

TIC/IP协议族按层次分别分为以下四层：

- 应用层
- 传输层
- 网络层
- 数据链路层

层次化的好处：

- 把各层之间的接口规划好后，各层次之间的设计相互独立，互不影响
- 设计简单，各层次之间彼此不透明，只提供接口

> 应用层

最上层的，我们直接接触到的就是应用层，电脑、手机上的APP都是在应用层上实现的。当两个不同设备上的应用需要通信时，应用就把数据传输给下一层，也就是传输层。

应用层只需专注为用户提供应用功能即可，例如：HTTP、FTP、DNS等

应用层工作在操作系统中的==用户态==，而传输层及以下则工作在==内核态==。

> 传输层

传输层为上层应用层，提供处于网络连接状态中的两台设备之间的数据传输；

![](https://gitee.com/lyydsheep/pic/raw/master/202401161800543.png)

在传输层有两个传输协议

- TCP（Transmission Control Protocol）
- UDP（User Data Protocol）

> 网络层（网络互连层）

数据包是网络传输的最小单位，网络层就是用来处理在网络上流动的数据包，在众多的选项内选择一条传输路线。

传输层作为应用间数据传输的媒介，帮助实现应用到应用之间的通信，==而实际的传输功能则交给网络层==

![image-20240116180934350](https://gitee.com/lyydsheep/pic/raw/master/202401161809447.png)

> 链路层（数据链路层、网络接口层）

用来处理网络连接的硬件部分，包括控制操作系统、硬件的设备驱动、网卡以及光纤等物理可见部分。

#### 1.2.3TCP/IP通信传输流

![image-20240116181947982](https://gitee.com/lyydsheep/pic/raw/master/202401161819080.png)

客户端在应用层（HTTP协议）发送一个HTTP请求；

接着传输层（TCP协议）为了传输方便，将HTTP请求报文进行分割，并在各个报文上打赏标记序号及端口号后转发给网络层；

在网络层（IP协议），增加作为通信目的地的MAC地址后转发给链路层。

发送端在层与层之间传输数据时，每经过一层，数据就会被打上该层所属的首部信息。反之，接收端则是去掉首部信息。

这种把数据信息包装起来的做法称为封装。

### 1.3与HTTP关系密切的协议：IP、TCP、DNS

#### 1.3.1负责传输的IP协议

IP协议位于网络层

IP协议的作用就是各种数据包传输给对方，为了保证确实传送到了对方，需要满足两个重要条件：

- IP地址：指明结点被分配到的地址，可改变
- MAC地址：是指网卡所属的固定地址，基本不会更改

数据在进行中转时，会利用下一站中转设备的MAC地址来搜索下一个中转目标，此时就会采用ARP协议可以根据通信方的IP地址就可以反查出对于的MAC地址。

#### 1.3.2确保可靠性的TCP协议

TCP协议位于网络层，提供可靠的字节分流服务。

TCP协议为了高效传输大数据，将数据分割，而且TCP协议能确认数据最终到达接收方。

为了确保数据最终达到接收方，TCP协议采用了三次握手的方式，握手过程中采用了TCP的标志：SYN（synchronize）和ACK（acknowledgement）

![image-20240116191650226](https://gitee.com/lyydsheep/pic/raw/master/202401161916379.png)

#### 1.3.3负责域名解析的DNS服务

DNS（Domain Name System）服务和HTTP协议一样位于应用层。DNS服务提供域名到IP地址的解析服务。

![image-20240116192125819](https://gitee.com/lyydsheep/pic/raw/master/202401161921939.png)

### 1.4各种协议与HTTP协议之间的关系

- 先用DNS服务解析域名，返回IP地址
- 生成HTTP请求报文
- TCP协议提供字节流服务，将数据分段
- IP协议一边搜索一边中转，中转过程会使用到ARP协议
- 到达目标服务器后，TCP再将报文段按序号合并成报文
- 应用层的HTTP再对请求报文的内容进行处理